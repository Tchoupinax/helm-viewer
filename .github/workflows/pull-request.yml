name: 1ï¸âƒ£ Pull request checks ğŸ”

on:
  pull_request:


jobs:
  lint:
    name: Check code quality ğŸ«†
    runs-on: ubuntu-latest
    steps:
    - name: Check code quality ğŸ«†
      uses: tchoupinax/repo-config/shared-actions/steps/node/lint@v0
      with:
        nodeVersion: 25
        pnpmVersion: 10.30.2
        throwOnError: false

  build:
    name: Check build success ğŸ¦«
    runs-on: ubuntu-latest
    steps:
    - name: Check build success ğŸ¦«
      uses: tchoupinax/repo-config/shared-actions/steps/node/build@v0
      with:
        nodeVersion: 25
        pnpmVersion: 10.30.2

  labels:
    name: Autodetect labels ğŸ”
    runs-on: ubuntu-latest
    steps:
    - name: Autodetect labels ğŸ”
      uses: tchoupinax/repo-config/shared-actions/steps/dx/automatically-apply-labels@v0
      with:
        appId: ${{ secrets.DEPLOY_APP_ID }}
        privateKey: ${{ secrets.DEPLOY_APP_KEY }}

  invite-publication:
    name: Invite to publish CLI
    runs-on: ubuntu-latest
    needs: [ lint, build, labels ]
    if: ${{ github.event_name == 'pull_request' }}
    permissions:
      pull-requests: write
    steps:
    - name: Comment with publish link
      uses: peter-evans/create-or-update-comment@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        issue-number: ${{ github.event.pull_request.number }}
        body: |
          â¡ï¸ **Publish next CLI version**

          Click here to open the publish workflow, then press **Run workflow** on that page:
          https://github.com/${{ github.repository }}/actions/workflows/publish-cli.yml
